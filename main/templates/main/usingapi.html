{% extends "main/base.html" %}
{% block title %}<title>WHG::Architecture</title>{% endblock %}

{% block content %}
{% load fontawesome %}
{% load static %}

  <div class="container">
    <div class="d-flex justify-content-center mt-3">
      <h3>Using the API</h3>
    </div>
    <div id="api_content" class="mx-3">
      <!--<p class="lead">Pipeline, architecture, and software</p>-->
        <div class="row">
          <div class="col-sm-6">  
            <p class="mb-2">Development of the external API is in draft stage. We plan to refine options and add endpoints in response to community feedback. Please <a href="#">use this form for suggestions</a>.</p>
			
			<h5 class="red-head strong">Two place data stores</h5>
			
            <p>The <b class="red-head">relational database</b> holds individual records from uploaded datasets</p>
            <p class="ml-2 notebox small">Note that records from all uploaded datasets are assigned a unique identifier within the WHG system (<b>place_id</b>). Both that place_id and the contributor's own <b>src_id</b> will be maintained unless and until the dataset is deleted by its owner. If a dataset is flagged as "public," its records will be accessible via the "database API" as indicated. In this way WHG can serve as a Linked Open Data publisher for those projects unable to stand up their own per-record landing pages.</p>
			
            <p>The <b class="red-head">"union index"</b>: links <i>contributed</i> records deemed to be close or exact matches in the optional accessioning step that follows initial uploading and reconciliation tasks. So, results of an index query may return one or several records as distinct attestations of the "same" place.</p>
			
            <h5 class="red-head strong ">Trace data</h5>
            <p>We have indexed a limited number of "trace annotation" datasets, which can be searched by keyword. Trace records can optionally be returned in place searches,</p>
          </div>
          <div class="col-sm-6">
            <h5 class="strong red-head">Endpoints</h5> <!-- &#x2609; -->
            <p class="docs-subhead1">Places</p>
            <div class="pl-1 smallish arial">
              <p class="mb-0 strong">Search public database records:</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/searchdb?</p>
              <p class="ml-1 my-0 hang"><b>parameters</b>: q <i>(&lt;str&gt;)</i>; dataset<i> (id, &lt;int&gt; or label, &lt;str&gt;)</i>; 
				<span class="nobr">ccode <i>(ISO 2-letter, >=1)</i>; </span>
				<span class="nobr">fclass <i>(geonames feature class&nbsp;<a href="#" class="red-head" data-html="true" onClick='return false;' title="A=administrative; H=hydrological; L=landscape; P=settlements;<br/> S='sites';<br/> T=topographical" rel="tooltip"> {% fontawesome_icon 'question-circle' %}</a>; >=1)</i>; </span>
				</span><span class="nobr">earliest <i>(not before, &lt;int&gt;)</i>; </span><span class="nobr">latest <i>(not after, &lt;int&gt;)</i>; </span><span class="nobr">area <i>(&lt;int&gt;)</i>; </span>
			  </p>
              <p class="ml-1 my-0 hang"><b>example</b>: whgazetteer.org/api/searchdb?</p>
              
              <p class="mb-0 mt-2 strong">Search union index (returns linked, accessioned records):</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/searchidx?</p>
              <p class="ml-1 my-0"><b>parameters</b>: q (string); </p>
              <p class="ml-1 my-0 hang"><b>example</b>: </p>

              <p class="mb-0 mt-2 strong">Single place record by id:</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/place/<i>place_id</i></p>
              <p class="ml-1 my-0 hang"><b>example</b>: </p>
            </div>
			
            <p class="docs-subhead1 mt-2">Areas (incl. regions; user study areas)</p>
			<div class="pl-1 smallish arial">
			  <p class="mb-0 strong">Search database records:</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/areas?</p>
              <p class="ml-1 my-0"><b>parameters</b>: q <i>(&lt;str&gt;)</i>; <span class="nobr">ccode <i>(overlaps bounds, ISO 2-letter)</i>; </span>
			  </p>
              <p class="ml-1 my-0 hang"><b>example</b>: </p>
			</div>
            <p class="docs-subhead1 mt-2">Datasets</p>
			<div class="pl-1 smallish arial">
              <p class="mb-0 mt-2 strong">Single dataset record by id:</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/dataset/<i>place_id</i></p>
              <p class="ml-1 my-0 hang"><b>example</b>: </p>
              <p class="mb-0 mt-2 strong">List public datasets:</p>
              <p class="ml-1 my-0"><b>url</b>: whgazetteer.org/api/datasets/</p>
              <p class="ml-1 my-0 hang"><b>example</b>: </p>
			</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
	$(function(){
	  $("[rel='tooltip']").tooltip();
	})
  </script>
{% endblock %}
